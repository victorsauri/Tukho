<div class="background">
	<div class = "container">
	</br>
		<ul>
	    <% @events.each do |event| %>
	      	<li class="list-group-item list-group-item-danger list_event">
		      	<div class="text_li">
		      		<%= event.name %> - <%= event.description %> - <%= event.date.strftime("#{event.date.day.ordinalize} %B %Y") %> - <%= event.location %> - <%= event.starting_time.strftime(" Start: %H:%M")%> - <%= event.finishing_time.strftime(" Finish: %H:%M") %> 
					<% if @connectors.pluck(:event_id).include? event.id %>
						<a id="joined" href="">Joined</a>
						<%= link_to "Edit yout color", event_path(event.id), class: 'btn btn-success join' %>
					<% else %>
			       		<%= link_to "Join this event", event_path(event.id), class: 'btn btn-success join' %>
			      	<% end %>
				    <span class='count_all'>
				    	<%= @total_sum.where(event_id: event.id).count %>
				    </span>Tukhos
				    <span class='green_count'>
				     	<%= @all_connectors.where(event_id: event.id).where(color: "green").count %>
				    </span>Greens
				    <span class='orange_count'>
				     	<%= @all_connectors.where(event_id: event.id).where(color: "orange").count %>
				    </span>Oranges
				    <span  class='red_count'>
				     	<%= @all_connectors.where(event_id: event.id).where(color: "red").count %>
				    </span>Reds
				</div>
			    <canvas id="Gauge" class="Gauge" width="125" height="82" style="width: 100px; height: 71px;"></canvas>
	        </li>
	    <% end %>
		</ul>
	</div>
</div>

<script>
	var opts = {
	  lines: 12,
	  angle: 0.15,
	  lineWidth: 0.44,
	  pointer: {
	    length: 0.9,
	    strokeWidth: 0.035,
	    color: 'gold'
	  },
	  limitMax: 'false',
	  colorStart: '#097B09',
	  strokeColor: '#AC3518',
	  generateGradient: true
	};

	var events = document.getElementsByClassName('list_event');
	for (var i = 0; i < events.length; i++) {
	  var total = parseFloat(events[i].getElementsByClassName('count_all')[0].innerHTML);
	  var green = parseFloat(events[i].getElementsByClassName('green_count')[0].innerHTML);
	  var target = events[i].getElementsByClassName('Gauge')[0];
	  var gauge = new Gauge(target).setOptions(opts);
	  gauge.maxValue = total
	  gauge.animationSpeed = 72;
	  gauge.set(green);
	};
</script>


<!-- percentColors: [[0.0,'#9A130C'],[red/total,'#9A130C'],[(red+orange)/total, '#f9c802'], [(total-orange)/total,'#097B09'],[1.0,'#097B09']] -->

<!-- strokeColor: [[0.0,'#9A130C'],[red/total,'#9A130C'],[(red+orange)/total, '#f9c802'], [(total-orange)/total,'#9A130C'],[1.0,'#097B09']], -->

<!-- <div id="preview-textfield" style="font-size: 41px;">1,250</div> -->

<!-- for (var i = 0, i<8, i++) {}; -->